
<head> </head>

<% if !@access_token.blank? %>
  <p>user logged in: <%= @access_token %></p>
<% else %>
  <p>user not logged in</p>
=======
<% content_for :pagejs do %>
  <script src="http://cdn.optimizely.com/js/141715440.js"></script>

<% end %>

<img class="bg" src="/assets/nine.jpg">

  <h1 id = "where"> I'M FEELING . . .</h1>
   <form name="mood_form">
    <div id="radio">
      <input type="radio" id="radio2" name="radio" onclick="get_radio_value()" value="adventurous"/><label class="list"  for="radio2">ADVENTUROUS</label>
      <input type="radio" id="radio3" name="radio" onclick="get_radio_value()" value="drinks"/><label class="list"  for="radio3">A GOOD TIME</label>
      <input type="radio" id="radio4" name="radio" onclick="get_radio_value()" value="artsy"/><label class="list" for="radio4">ARTSY</label>
      <input type="radio" id="radio5" name="radio" onclick="get_radio_value()" value="food"/><label class="list" for="radio5">FOODIE</label>
      <input type="radio" id="radio6" name="radio" onclick="get_radio_value()" value="stylish"/><label class="list" for="radio6">STYLISH</label>
      <input type="radio" id="radio7" name="radio" onclick="get_radio_value()" value="toppicks"/><label class="list" for="radio7">SPECIAL</label>
      
    </div>
  </form>

<span class="nav1"><a href="..">BACK</a></span><span class="nav2"><a class="next" href="#">NEXT</a></span> 


<div id = "seeCircles"><a class="circles">OR GO TO FRIEND LIST...</a></div>



  <script>
  var a=document.getElementsByTagName("a");
  for(var i=0;i<a.length;i++){
      a[i].onclick=function(){
          window.location=this.getAttribute("href");
          return false
      }
  }

  $(function() {
        $( "#radio" ).buttonset();
    });
  </script>



  <script>
  $(document).ready(function () {
    mood_tag = "food";

    // get access_token to use for authenticated api calls
    // access_token;
    var q = document.URL.split('#')[1];
    if(q != undefined){
      q = q.split('=')[1];
      access_token = q;
      }

    console.log("my access token: " + access_token);
    
    $.get('/user/login', {token: access_token}, function(data){
      if(data == "OK"){
        console.log("Successfully logged in user!");
        $(".circles").attr("href", "../soc_wave_list/callback#access_token=" + access_token);
      } else if(data == "NOK"){
        console.log("Error logging in user!");
        //window.location.href="/";
      }
    });
   });

    // return the value of the radio button that is checked
    // return an empty string if none are checked, or
    // there are no radio buttons
    function get_radio_value() {
      console.log(access_token);
      // var next = "<a href='../soc_wave_list?mood_tag=" + mood_tag + "'>NEXT</a>";
      var radio_length = document.mood_form.radio.length;
      for(var i = 0; i < radio_length; i++) {
        if(document.mood_form.radio[i].checked){
          mood_tag = document.mood_form.radio[i].value;
          var href_mood = "../soc_wave_list?mood_tag=" + mood_tag +"&access_token=" +access_token;
          console.log(href_mood);

          $(".next").attr('href', href_mood);
  
        }
      }

    }


  </script>
